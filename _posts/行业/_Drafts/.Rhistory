html_nodes(".entry-title  a") %>%
html_attr("href")
link <- url %>%
read_html(encoding="GB18030") %>%
html_nodes(" a") %>%
html_attr("href")
url <- "http://www.r-bloggers.com/"          ## John Cochrane's blog
link <- url %>%
read_html() %>%
html_nodes("a") %>%
html_attr("href")
link
link <- url %>%
read_html() %>%
html_nodes("h2 a") %>%
html_attr("href")
link
link <- url %>%
read_html() %>%
html_nodes("#twocol h2 a") %>%
html_attr("href")
link
url <- "http://www.r-bloggers.com/"          ## John Cochrane's blog
link <- url %>%
read_html() %>%
html_nodes("#leftcontent h2 a") %>%
html_attr("href")
link
x= link[1]
title  <- x %>%
read_html() %>%
html_nodes("h1") %>%
html_text()
title
main <- x %>%
read_html()  %>%
html_nodes("p") %>%
html_text()
main
date <- x %>%
read_html() %>%
html_nodes(".date") %>%
html_text()
date
author <- x %>%
read_html() %>%
html_nodes("#author") %>%
html_text()
author
author <- x %>%
read_html() %>%
html_nodes("#meta") %>%
html_text()
author
author <- x %>%
read_html() %>%
html_nodes("#meta p") %>%
html_text()
author
url <- "http://www.r-bloggers.com/"          ## John Cochrane's blog
link <- url %>%
read_html() %>%
html_nodes("#leftcontent h2 a") %>%
html_attr("href")
article <- function(x){
link <- x
title  <- x %>%
read_html() %>%
html_nodes("h1") %>%
html_text()
date <- x %>%
read_html() %>%
html_nodes(".date") %>%
html_text()
main <- x %>%
read_html()  %>%
html_nodes("p") %>%
html_text() %>%
paste(., collapse = '\n                                                                                              \n')
all <- list(link, title, date, main)   ## all information: link, title, date, main
return(all)
}
inf <- lapply(link[1], article)
inf
lnk
link
---
)
url <- "http://epaper.stcn.com/paper/zqsb/html/epaper/index/index.htm"
link <- url %>%
read_html() %>%
html_nodes("li   a") %>%
html_attr("href") %>%
gsub("content_", "http://epaper.stcn.com/paper/zqsb/html/epaper/index/content_", .) %>%
.[-c(1:6)] %>%
.[1:10]
article <- function(x){
link <- x
title  <- x %>%
read_html() %>%
html_nodes(".main  h2") %>%
html_text()
author <- x %>%
read_html() %>%
html_nodes(".from") %>%
html_text()
main <- x %>%
read_html()  %>%
html_nodes(".txtWrap   p") %>%
html_text() %>%
paste(., collapse = '\n\n')
all <- list(link, title, author, main)   ## all information: link, title, date, main
return(all)
}
inf <- lapply(link[1:10], article)
library(rvest)
library(beepr)
url <- "http://epaper.stcn.com/paper/zqsb/html/epaper/index/index.htm"
link <- url %>%
read_html() %>%
html_nodes("li   a") %>%
html_attr("href") %>%
gsub("content_", "http://epaper.stcn.com/paper/zqsb/html/epaper/index/content_", .) %>%
.[-c(1:6)] %>%
.[1:10]
article <- function(x){
link <- x
title  <- x %>%
read_html() %>%
html_nodes(".main  h2") %>%
html_text()
author <- x %>%
read_html() %>%
html_nodes(".from") %>%
html_text()
main <- x %>%
read_html()  %>%
html_nodes(".txtWrap   p") %>%
html_text() %>%
paste(., collapse = '\n\n')
all <- list(link, title, author, main)   ## all information: link, title, date, main
return(all)
}
inf <- lapply(link[1:10], article)
inf[[1]][[3]]
inf[[1]][[4]]
inf[[1]]
link
library(rvest)
library(beepr)
url <- "http://epaper.stcn.com/paper/zqsb/html/epaper/index/index.htm"
link <- url %>%
read_html() %>%
html_nodes("li   a") %>%
html_attr("href") %>%
gsub("content_", "http://epaper.stcn.com/paper/zqsb/html/epaper/index/content_", .) %>%
.[-c(1:6)] %>%
.[1:10]
link <- url %>%
read_html() %>%
html_nodes("li   a") %>%
html_attr("href")
link <- url %>%
read_html(encoding="GB18030") %>%
html_nodes("li   a") %>%
html_attr("href")
link <- url %>%
read_html(encoding="GB18030") %>%
html_nodes("li   a") %>%
html_attr("href")
url <- "http://zqrb.ccstock.cn/html/2015-05/27/node_2.htm"
link <- url %>%
read_html(encoding="GB18030") %>%
html_nodes("#banmiancontent .vote_content12px") %>%
html_attr("href")
link <- url %>%
read_html() %>%
html_nodes("#banmiancontent .vote_content12px") %>%
html_attr("href")
link
link <- url %>%
read_html() %>%
html_nodes("#banmiancontent .vote_content12px") %>%
html_attr("href") %>%
gsub("content_", "http://epaper.stcn.com/paper/zqsb/html/epaper/index/content_", .) %>%
.[1:10]
link
url <- "http://zqrb.ccstock.cn/html/2015-05/27/node_2.htm"
link <- url %>%
read_html() %>%
html_nodes("#banmiancontent .vote_content12px") %>%
html_attr("href") %>%
gsub("content_", "http://epaper.stcn.com/paper/zqsb/html/epaper/index/content_", .)
link
head(link)
link <- url %>%
read_html() %>%
html_nodes("#banmiancontent .vote_content12px") %>%
html_attr("href")
head(link)
link <- url %>%
read_html() %>%
html_nodes("#banmiancontent .vote_content12px") %>%
html_attr("href") %>%
gsub("content_", "http://zqrb.ccstock.cn/html/2015-05/27/content_", .)
head(link)
x = link[1]
title  <- x %>%
read_html() %>%
html_nodes(".h1") %>%
html_text()
title
main <- x %>%
read_html()  %>%
html_nodes(".content  p") %>%
html_text()
main
article <- function(x){
link <- x
title  <- x %>%
read_html() %>%
html_nodes(".h1") %>%
html_text()
main <- x %>%
read_html()  %>%
html_nodes(".content  p") %>%
html_text() %>%
paste(., collapse = '\n\n')
all <- list(link, title, author, main)   ## all information: link, title, date, main
return(all)
}
inf <- lapply(link[1:10], article)
inf
link[3]
inf[[3]]
substr(Sys.Date(),1,6 )
substr(Sys.Date(),1,7)
substr(Sys.Date(),8,9)
substr(Sys.Date(),9,11)
url <- paste("http://zqrb.ccstock.cn/html/", substr(Sys.Date(),1,7), "/",substr(Sys.Date(),9,11), "/node_2.htm", sep="")
url
link <- url %>%
read_html() %>%
html_nodes("#A1   .vote_content12px") %>%
html_attr("href")
link
link <- url %>%
read_html() %>%
html_nodes("#A1   .vote_content12px") %>%
html_attr("href") %>%
gsub("content_", "http://zqrb.ccstock.cn/html/2015-05/27/content_", .)
link
url <- paste("http://zqrb.ccstock.cn/html/", substr(Sys.Date(),1,7), "/",substr(Sys.Date(),9,11), "/node_2.htm", sep="")
url <- paste("http://zqrb.ccstock.cn/html/", substr(Sys.Date(),1,7), "/",substr(Sys.Date(),9,11), "/node_2.htm", sep="")
url <- paste("http://zqrb.ccstock.cn/html/", substr(Sys.Date(),1,7), "/",substr(Sys.Date(),9,11), "/node_2.htm", sep="")
link <- url %>%
read_html() %>%
html_nodes("#banmiancontent .vote_content12px") %>%
html_attr("href") %>%
gsub("content_", "http://zqrb.ccstock.cn/html/2015-05/27/content_", .)
link
link2 <- url %>%
read_html() %>%
html_nodes("#banmiancontent td  img a") %>%
html_attr("href")
link2
link2 <- url %>%
read_html() %>%
html_nodes("img a") %>%
html_attr("href")
link2
link2 <- url %>%
read_html() %>%
html_nodes("img a") %>%
html_attr("src")
link2
url <- paste("http://zqrb.ccstock.cn/html/", substr(Sys.Date(),1,7), "/",substr(Sys.Date(),9,11), "/node_2.htm", sep="")
url
link2 <- url %>%
read_html() %>%
html_nodes("img a") %>%
html_attr("src")
link2
link2 <- url %>%
read_html() %>%
html_nodes("img a") %>%
html_attr("href")
link2
url
url =  "http://zqrb.ccstock.cn/html/2015-05/26/node_2.htm"
library(rvest)
library(beepr)
url <- "http://news.cnstock.com/bwsd201505271347"           ## 要闻
link <- url %>%
read_html() %>%
html_nodes("#bw-list  .title   a") %>%
html_attr("href")
require(knitr, quietly=TRUE, warn.conflicts=FALSE)
require(rmarkdown)
library(rvest)
url <- "http://www.ted.com/"
url <- "http://www.ted.com/"
link <- url %>%
read_html() %>%
html_nodes(".talk-grid__tile__details__title") %>%
html_attr("href")
link
url <- "http://www.ted.com/"
link <- url %>%
read_html() %>%
html_nodes(".talk-grid__tile__details__title a") %>%
html_attr("href")
link
url <- "http://www.ted.com/talks"
url <- "http://www.ted.com/talks"
link <- url %>%
read_html() %>%
html_nodes(".col  a") %>%
html_attr("href")
link
url <- "http://www.ted.com/talks"
link <- url %>%
read_html() %>%
html_nodes(".col  a") %>%
html_attr("href") %>%
.[-c(1:2)]
link
library(rvest)
library(downloader)
url <- "http://www.ted.com/talks"
link <- url %>%
read_html() %>%
html_nodes(".col  a") %>%
html_attr("href") %>%
.[-c(1:2)] %>%
gsub("/talks", "http://www.ted.com/talks", .)
link
x = link[1]
title  <- x %>%
read_html(encoding="GB18030") %>%
html_nodes(".controls__meta  .controls__meta__title") %>%
html_text()
title  <- x %>%
read_html() %>%
html_nodes(".controls__meta  .controls__meta__title") %>%
html_text()
title
title  <- x %>%
read_html() %>%
html_nodes(".controls__meta__title") %>%
html_text()
title  <- x %>%
read_html() %>%
html_nodes(".controls__meta__title") %>%
html_text()
title
title  <- x %>%
read_html() %>%
html_nodes(".player-hero__title__content") %>%
html_text()
title
x
speaker  <- x %>%
read_html() %>%
html_nodes(".player-hero__speaker__content") %>%
html_text()
speaker
date <- x %>%
read_html() %>%
html_nodes(".span") %>%
html_text()
date
date <- x %>%
read_html() %>%
html_nodes(".player-hero__meta") %>%
html_text()
date
file.link <-  x %>%
read_html(encoding="GB18030") %>%
html_nodes("#player-hero-play .download-button .player-hero__tools__icon") %>%
html_attr("href")
file.link <-  x %>%
read_html() %>%
html_nodes("#player-hero-play .download-button .player-hero__tools__icon") %>%
html_attr("href")
file.link
file.link <-  x %>%
read_html() %>%
html_nodes(".download-button .player-hero__tools__icon") %>%
html_attr("href")
file.link
file.link <-  x %>%
read_html() %>%
html_nodes(".download-button") %>%
html_attr("href")
file.link
file.link <-  x %>%
read_html() %>%
html_nodes(".talk-download__button--video") %>%
html_attr("href")
file.link
file.link <-  x %>%
read_html() %>%
html_nodes(".modal__content , .talk-download__button--video") %>%
html_attr("href")
file.link
get.nowdata=function(symbol){
options(warn =-1)
url_0=paste("http://vol.stock.hexun.com/Now/Share/DealDetail_1.ashx?rank=3&dealtype=0&code=",symbol,sep="")
raw_0=read.table(url_0,colClasses="character",fill=T,sep="[")
raw_1=strsplit(as.character(raw_0),",|]")
raw_2=unlist(raw_1)
raw_4=matrix(raw_2[-(1:4)],ncol=7,byrow=T)[,-7]
temp=tempfile()
write.table(raw_4,temp)
data=read.table(temp,dec="'")
for(i in 2:4){data[,i]=as.numeric(as.character(data[,i]))}
colnames(data)=c("Time","Volum","Price","Turnover","Orders","NIO")
list(symbol=raw_2[1],Company=raw_2[2],Date=raw_2[3],Details=data)
}
get.nowdata("000065")
get.nowdata("000516")
testit <- function(x = sort(runif(20)), ...)
{
pb <- txtProgressBar(...)
for(i in c(0, x, 1)) {Sys.sleep(0.5); setTxtProgressBar(pb, i)}
Sys.sleep(1)
close(pb)
}
testit()
testit(runif(10))
testit(style = 3)
rm(list=ls(all+TRUE))
rm(list=ls(all=TRUE))
testit(runif(10))
steps <- 50
library ("tcltk")
bar <- tkProgressBar (title="my small progress bar", min=0, max=steps, width=300)
for (i in 1:steps)
{
setTkProgressBar (bar, i, label=paste(round(i/steps*100, 0), "%"))
Sys.sleep (.1)
}
close(bar)
steps <- 50
library ("tcltk")
bar <- tkProgressBar (title="my small progress bar", min=0, max=steps, width=300)
for (i in 1:steps)
{
setTkProgressBar (bar, i, label=paste(round(i/steps*100, 0), "%"))
Sys.sleep (.1)
}
close(bar)
testit(runif(10))
steps <- 50
for (i in 1:steps)
{
cat ("\\r", paste (paste (rep ("O", 100*i/steps), collapse=""), "o", paste (rep (" ", 100 - 100*i/steps), collapse="")," ", 100*i/steps, "% ",sep=""))
Sys.sleep (.1)
}
cat ("\\n")
steps <- 50
library ("tcltk")
bar <- tkProgressBar (title="my small progress bar", min=0, max=steps, width=300)
for (i in 1:steps)
{
setTkProgressBar (bar, i, label=paste(round(i/steps*100, 0), "%"))
Sys.sleep (.1)
}
close(bar)
steps <- 50
for (i in 1:steps)
{
cat ("\\r", 100*i/steps, "% ", sep="")
Sys.sleep (.1)
}
cat ("\\n")
steps <- 50
for (i in 1:steps)
{
print (paste (i, "of", steps))
Sys.sleep (.1)
}
library(MASS)
data(npk)
aov.npk <- aov(yield ~ block + N * P * K, npk)
print(ascii(summary(aov.npk)), "rest")
install.packages("ascii")
print(ascii(summary(aov.npk)), "rest")
library(ascii)
print(ascii(summary(aov.npk)), "rest")
install.packages("stargazer")
install.packages("stargazer")
library(devtools)
install.github("cran/stargazer")
install_github("cran/stargazer")
library(stargazer)
stargazer(aov.npk, summary=FALSE)
stargazer(aov.npk)
## 2 OLS models
linear.1 <- lm(rating ~ complaints + privileges + learning + raises + critical, data=attitude)
linear.2 <- lm(rating ~ complaints + privileges + learning, data=attitude)
## create an indicator dependent variable, and run a probit model
attitude$high.rating <- (attitude$rating > 70)
probit.model <- glm(high.rating ~ learning + critical + advance, data=attitude, family = binomial(link = "probit"))
stargazer(linear.1, linear.2, probit.model, title="Regression Results", align=TRUE)
stargazer(linear.1, linear.2, title="Regression Results",
dep.var.labels=c("Overall Rating","High Rating"),
order=c("learning", "privileges"),
keep.stat="n", ci=TRUE, ci.level=0.90, single.row=TRUE)
stargazer(linear.1, linear.2, probit.model, title="Regression Results", align=TRUE,type = 'html')
source('~/finance/_posts/行业/_Drafts/industry.R', echo=TRUE)

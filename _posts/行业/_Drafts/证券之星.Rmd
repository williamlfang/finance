---
layout:   post
title:    "证券之星"
category: strategy
tags:     
    -  
    -   
description: 
published: false
status:    process
---


```{r echo=FALSE, warning=FALSE, message=FALSE}
# if you do not have it already, install the devtools package install.packages("devtools") 
# devtools::install_github("hadley/rvest") 
library(rvest)
```

<!------------------------------------------------------------------------------------------------------->
<!------------------------------------------------------------------------------------------------------->

## 板块掘金

```{r echo=FALSE, warning=FALSE, message=FALSE}
url <- "http://stock.stockstar.com/list/sectors.htm"

link <- url %>% 
  read_html(encoding="GB18030") %>% 
  html_nodes(".listtable  li  a") %>% 
  html_attr("href")


article <- function(x){
    link <- x
  
    title  <- x %>% 
    read_html(encoding="GB18030") %>% 
    html_nodes("h1") %>% 
    html_text()

  page.numbers <- x %>% 
    read_html(encoding="GB18030")  %>% 
    html_nodes("#Page a") %>% 
    html_text() %>%
    as.numeric()
  page.numbers <- page.numbers[1:length(page.numbers)-1]

  date <- x %>% 
    read_html(encoding="GB18030") %>% 
    html_nodes("#pubtime_baidu") %>% 
    html_text()

  url0 <- strsplit(x, "\\.shtml")

  url.new <- rep( NA, length(page.numbers) )
    for ( i in 1:length(page.numbers) ){
    url.new[i] <- paste(url0, "_", i, ".shtml", sep="")
  }

  text <- function(x){
    text <- x %>%
    read_html(encoding="GB18030")  %>% 
    html_nodes("#container-article  p") %>% 
    html_text()
  
    text <- text[3:length(text)-1]
  }

main <- lapply(url.new, text)

tidai <- function(x){
  # y = paste(x, collapse = '\t ============================================================================ \t')
  y = paste(x, collapse = '\n\n')
  return(y)
} 

  main <- main %>%
    sapply(., tidai) %>%
    as.character() %>%
    gsub("个股资料|操作策略|咨询高手|实盘买卖|基金持仓：,", "", .) %>%
    gsub("(\\（|\\）)","\n==========\n", .)
  
  all <- list(link, title, date, main)   ## all information: link, title, date, main
  return(all)
}

inf = lapply(link, article)
##:
## inf[[]][[1]]: link
## inf[[]][[2]]: title
## inf[[]][[3]]: date
## inf[[]][[4]]: main
```

<!------------------------------------------------------------------------------------------------------->

### `r inf[[1]][[2]]`
[`r inf[[1]][[3]]`](`r inf[[1]][[1]]`)

`r inf[[1]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[2]][[2]]`
[`r inf[[2]][[3]]`](`r inf[[2]][[1]]`)

`r inf[[2]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[3]][[2]]`
[`r inf[[3]][[3]]`](`r inf[[3]][[1]]`)

`r inf[[3]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[4]][[2]]`
[`r inf[[4]][[3]]`](`r inf[[4]][[1]]`)

`r inf[[4]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[5]][[2]]`
[`r inf[[5]][[3]]`](`r inf[[5]][[1]]`)

`r inf[[5]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[6]][[2]]`
[`r inf[[6]][[3]]`](`r inf[[6]][[1]]`)

`r inf[[6]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[7]][[2]]`
[`r inf[[7]][[3]]`](`r inf[[7]][[1]]`)

`r inf[[7]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[8]][[2]]`
[`r inf[[8]][[3]]`](`r inf[[8]][[1]]`)

`r inf[[8]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[9]][[2]]`
[`r inf[[9]][[3]]`](`r inf[[9]][[1]]`)

`r inf[[9]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[10]][[2]]`
[`r inf[[10]][[3]]`](`r inf[[10]][[1]]`)

`r inf[[10]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[11]][[2]]`
[`r inf[[11]][[3]]`](`r inf[[11]][[1]]`)

`r inf[[11]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[12]][[2]]`
[`r inf[[12]][[3]]`](`r inf[[12]][[1]]`)

`r inf[[12]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[13]][[2]]`
[`r inf[[13]][[3]]`](`r inf[[13]][[1]]`)

`r inf[[13]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[14]][[2]]`
[`r inf[[14]][[3]]`](`r inf[[14]][[1]]`)

`r inf[[14]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[15]][[2]]`
[`r inf[[15]][[3]]`](`r inf[[15]][[1]]`)

`r inf[[15]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[16]][[2]]`
[`r inf[[16]][[3]]`](`r inf[[16]][[1]]`)

`r inf[[16]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[17]][[2]]`
[`r inf[[17]][[3]]`](`r inf[[17]][[1]]`)

`r inf[[17]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[18]][[2]]`
[`r inf[[18]][[3]]`](`r inf[[18]][[1]]`)

`r inf[[18]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[19]][[2]]`
[`r inf[[19]][[3]]`](`r inf[[19]][[1]]`)

`r inf[[19]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[20]][[2]]`
[`r inf[[20]][[3]]`](`r inf[[20]][[1]]`)

`r inf[[20]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[21]][[2]]`
[`r inf[[21]][[3]]`](`r inf[[21]][[1]]`)

`r inf[[21]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[22]][[2]]`
[`r inf[[22]][[3]]`](`r inf[[22]][[1]]`)

`r inf[[22]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[23]][[2]]`
[`r inf[[23]][[3]]`](`r inf[[23]][[1]]`)

`r inf[[23]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[24]][[2]]`
[`r inf[[24]][[3]]`](`r inf[[24]][[1]]`)

`r inf[[24]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[25]][[2]]`
[`r inf[[25]][[3]]`](`r inf[[25]][[1]]`)

`r inf[[25]][[4]]`

<!------------------------------------------------------------------------------------------------------->

<!------------------------------------------------------------------------------------------------------->
<!------------------------------------------------------------------------------------------------------->

## 个股掘金

```{r echo=FALSE, warning=FALSE, message=FALSE}
url <- "http://stock.stockstar.com/list/share.htm"

link <- url %>% 
  read_html(encoding="GB18030") %>% 
  html_nodes(".listtable  li  a") %>% 
  html_attr("href")


article <- function(x){
    link <- x
  
    title  <- x %>% 
    read_html(encoding="GB18030") %>% 
    html_nodes("h1") %>% 
    html_text()

  page.numbers <- x %>% 
    read_html(encoding="GB18030")  %>% 
    html_nodes("#Page a") %>% 
    html_text() %>%
    as.numeric()
  page.numbers <- page.numbers[1:length(page.numbers)-1]

  date <- x %>% 
    read_html(encoding="GB18030") %>% 
    html_nodes("#pubtime_baidu") %>% 
    html_text()

  url0 <- strsplit(x, "\\.shtml")

  url.new <- rep( NA, length(page.numbers) )
    for ( i in 1:length(page.numbers) ){
    url.new[i] <- paste(url0, "_", i, ".shtml", sep="")
  }

  text <- function(x){
    text <- x %>%
    read_html(encoding="GB18030")  %>% 
    html_nodes("#container-article  p") %>% 
    html_text()
  }

main <- lapply(url.new, text)

tidai <- function(x){
  y = paste(x, collapse = '\n\n')
  return(y)
}

  main <- main %>%
    sapply(., tidai) %>%
    as.character() %>%
    gsub("个股资料|操作策略|咨询高手|实盘买卖", "", .) %>%
    gsub("(\\（|\\）)","\n\n", .)
  
  all <- list(link, title, date, main)   ## all information: link, title, date, main
  return(all)
}

inf = lapply(link, article)
##:
## inf[[]][[1]]: link
## inf[[]][[2]]: title
## inf[[]][[3]]: date
## inf[[]][[4]]: main
```

<!------------------------------------------------------------------------------------------------------->

### `r inf[[1]][[2]]`
[`r inf[[1]][[3]]`](`r inf[[1]][[1]]`)

`r inf[[1]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[2]][[2]]`
[`r inf[[2]][[3]]`](`r inf[[2]][[1]]`)

`r inf[[2]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[3]][[2]]`
[`r inf[[3]][[3]]`](`r inf[[3]][[1]]`)

`r inf[[3]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[4]][[2]]`
[`r inf[[4]][[3]]`](`r inf[[4]][[1]]`)

`r inf[[4]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[5]][[2]]`
[`r inf[[5]][[3]]`](`r inf[[5]][[1]]`)

`r inf[[5]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[6]][[2]]`
[`r inf[[6]][[3]]`](`r inf[[6]][[1]]`)

`r inf[[6]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[7]][[2]]`
[`r inf[[7]][[3]]`](`r inf[[7]][[1]]`)

`r inf[[7]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[8]][[2]]`
[`r inf[[8]][[3]]`](`r inf[[8]][[1]]`)

`r inf[[8]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[9]][[2]]`
[`r inf[[9]][[3]]`](`r inf[[9]][[1]]`)

`r inf[[9]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[10]][[2]]`
[`r inf[[10]][[3]]`](`r inf[[10]][[1]]`)

`r inf[[10]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[11]][[2]]`
[`r inf[[11]][[3]]`](`r inf[[11]][[1]]`)

`r inf[[11]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[12]][[2]]`
[`r inf[[12]][[3]]`](`r inf[[12]][[1]]`)

`r inf[[12]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[13]][[2]]`
[`r inf[[13]][[3]]`](`r inf[[13]][[1]]`)

`r inf[[13]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[14]][[2]]`
[`r inf[[14]][[3]]`](`r inf[[14]][[1]]`)

`r inf[[14]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[15]][[2]]`
[`r inf[[15]][[3]]`](`r inf[[15]][[1]]`)

`r inf[[15]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[16]][[2]]`
[`r inf[[16]][[3]]`](`r inf[[16]][[1]]`)

`r inf[[16]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[17]][[2]]`
[`r inf[[17]][[3]]`](`r inf[[17]][[1]]`)

`r inf[[17]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[18]][[2]]`
[`r inf[[18]][[3]]`](`r inf[[18]][[1]]`)

`r inf[[18]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[19]][[2]]`
[`r inf[[19]][[3]]`](`r inf[[19]][[1]]`)

`r inf[[19]][[4]]`

<!------------------------------------------------------------------------------------------------------->

### `r inf[[20]][[2]]`
[`r inf[[20]][[3]]`](`r inf[[20]][[1]]`)

`r inf[[20]][[4]]`

<!------------------------------------------------------------------------------------------------------->

<!------------------------------------------------------------------------------------------------------->

```{r}
# install.packages("beepr")
library(beepr)
beep()
```